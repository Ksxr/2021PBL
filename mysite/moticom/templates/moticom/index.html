{% extends 'moticom/base.html' %}

{% load i18n static %}

{% block content %}
    <body>
        <script src="{% static 'moticom/js/chart.js/dist/chart.js' %}"></script>
        <div class="container">
            <h2 class="mt-4 border-bottom">ダッシュボード</h2>
            <div style="display:inline-block; width: 300px; height:300px">
                <canvas id="monthly" width="300px" height="300px"></canvas>
                    <script>
                        const monthly_label_list =  JSON.parse('{{ monthly_day_list|safe }}');
                        const monthly_data_list = JSON.parse('{{ monthly_data_list|safe }}');
                        var ctx = document.getElementById('monthly').getContext('2d');
                        var chart = new Chart(ctx, {
                        // The type of chart we want to create
                        type: 'line',
                        // The data for our dataset
                        data: {
                            labels: monthly_label_list,
                            datasets: [{
                                yAxisID: 'yAxes_1',
                                label: '',
                                backgroundColor: 'rgb(255, 99, 0)',
                                borderColor: 'rgb(255, 99, 132)',
                                data: monthly_data_list
                            }]
                        },
                        // Configuration options go here
                        options: {
                            scales: {
                                    "yAxes_1":{
                                            beginAtZero: true,
                                            ticks:{
                                                stepSize: 1
                                            }
                                    }
                            }
                        }
                    });
                    </script>
            </div>
            <div style="display:inline-block; width: 300px; height:300px">
                <canvas id="weekly" width="300px" height="300px"></canvas>
                    <script>
                        const weekly_label_list =  JSON.parse('{{ weekly_day_list|safe }}');
                        const weekly_data_list = JSON.parse('{{ weekly_data_list|safe }}');
                        var ctx = document.getElementById('weekly').getContext('2d');
                        var chart = new Chart(ctx, {
                        // The type of chart we want to create
                        type: 'line',
                        // The data for our dataset
                        data: {
                            yAxisID: 'yAxes_2',
                            labels: weekly_label_list,
                            datasets: [{
                                label: '',
                                backgroundColor: 'rgb(255, 99, 0)',
                                borderColor: 'rgb(255, 99, 132)',
                                data: weekly_data_list
                            }]
                        },
                        // Configuration options go here
                        options: {
                            scales: {
                                    "yAxes_2":{
                                            beginAtZero: true,
                                            ticks:{
                                                stepSize: 1
                                            }
                                        }
                                  }
                        }
                    });
                    </script>
            </div>
            <div style="display:inline-block; width: 300px; height:300px">
                <canvas id="bymonth" width="300px" height="300px"></canvas>
                    <script>
                        const bymonth_label_list =  JSON.parse('{{ bymonth_day_list|safe }}');
                        const bymonth_data_list = JSON.parse('{{ bymonth_data_list|safe }}');
                        var ctx = document.getElementById('bymonth').getContext('2d');
                        var chart = new Chart(ctx, {
                        // The type of chart we want to create
                        type: 'line',
                        // The data for our dataset
                        data: {
                            yAxisID: 'yAxes_3',
                            labels: bymonth_label_list,
                            datasets: [{
                                label: '',
                                backgroundColor: 'rgb(255, 99, 0)',
                                borderColor: 'rgb(255, 99, 132)',
                                data: bymonth_data_list
                            }]
                        },
                        // Configuration options go here
                        options: {
                            scales: {
                                    "yAxes_3":{
                                            beginAtZero: true,
                                            ticks:{
                                                stepSize: 1
                                            }
                                        }
                                }
                        }
                    });
                    </script>
            </div>
            <h2 class="mt-2 border-bottom pb-2">新着投稿</h2>
            <div class="d-flex flex-column pt-3">
                 {% if latest_report_list %}
                        {% for report in latest_report_list %}
                            <div class="card" style="background: rgb(150, 200, 200)">
                                <p class="ps-3 pb-3 mt-0 mb-0 small lh-sm border-bottom">
                                    <strong class="d-block">@{{ report.user_id }}</strong>
                                    {{ report.report_text }}
                                </p>
                            </div>
                        {% endfor %}
                {% else %}
                        <p class="pb-3 mb-0 small lh-sm border-bottom">
                            投稿がありません
                        </p>
                {% endif %}
            </div>
        </div>
    </body>
{% endblock content %}